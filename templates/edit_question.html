<html>

   <head>
    <title>Modifier question</title>
      <link href="{{ url_for('static', filename = 'style.css') }}" rel="stylesheet">
      <link href="{{ url_for('static', filename = 'style.css') }}" rel="stylesheet">
      <script src="{{ url_for('static', filename = 'bootstrap.bundle.min.js') }} "></script>
      <script src="{{ url_for('static', filename = 'bootstrap.bundle.min.js.map') }} " ></script>
      <link href="{{ url_for('static', filename = 'bootstrap.min.css.map') }} " rel="stylesheet">
      <link href="{{ url_for('static', filename = 'bootstrap.min.css') }} " rel="stylesheet">
      <!-- Bootstrap 5 CSS --><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css" integrity="sha384-r4NyP46KrjDleawBgD5tp8Y7UzmLA05oM1iAEQ17CSuDqnUK2+k9luXQOfXJCJ4I" crossorigin="anonymous">
      <!-- Font Awesome CSS --><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">    

      <script src="{{ url_for('static', filename = 'etiquettes.js') }} "></script>
      <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
      <script>
        var nbAnswers = parseInt("{{ nbAnswers }}");
        function addAnswer() {
            answers = document.getElementById("answers");
            answer = document.createElement("div");
            answer.id = "answer" + nbAnswers;
            answerCheckbox = document.createElement("input");
            answerCheckbox.type = "checkbox";
            answerCheckbox.name = "correct" + nbAnswers;
            answerCheckbox.value = "1";
            answerText = document.createElement("input");
            answerText.type = "text";
            answerText.name = "text" + nbAnswers;
            answerText.placeholder = "Réponse " + (nbAnswers + 1);
            answer.appendChild(answerCheckbox);
            answer.appendChild(answerText);
            answers.appendChild(answer);
            nbAnswers++;
            nbAnswersInput = document.getElementById("nbAnswers");
            nbAnswersInput.value = nbAnswers;
        }
        function delAnswer() {
            answer = document.getElementById("answer" + (nbAnswers - 1));
            answers.removeChild(answer);
            nbAnswers--;
            nbAnswersInput = document.getElementById("nbAnswers");
            nbAnswersInput.value = nbAnswers;
        }
        window.onload = function() {
            majInputEtiquettes();
        }
      </script>
   </head>
   
   <body>
    <center>
        <h1>modification de question</h1>
        <form method="post">
            <p>Type : {{ question.type }}</p>

            <label for="text">Question :</label>
            <input type="text" name="text" placeholder="Quelle est la capitale de la France ?" value="{{ question.text }}">
            
            <br><br><!-- Supprimer les BR et les remplacer par du css -->

            <div id="form-etiquettes" style="border: solid grey 1px; padding: 10px;">
                <label for="etiquette">Etiquettes :</label>
                <div id="etiquettes-list">
                    {% for etiquette in question.etiquettes %}
                    <div id="{{ etiquette }}" class="etiquette">
                        <p>{{ etiquette }}</p>
                        <button type="button" onclick="delEtiquette('{{ etiquette }}')">Supprimer</button>
                    </div>
                    {% endfor %}
                </div>
                <input type="hidden" name="etiquettes" value="" id="etiquettes">
                <div id="add_etiquette">
                    <input type="text" list="etiquettes_existantes" name="etiquette" placeholder="Ajouter une étiquette">
                    <datalist id="etiquettes_existantes">
                        {% for etiquette in etiquettes %}
                            <option value="{{ etiquette }}">
                        {% endfor %}
                    </datalist>
                    <button type="button" onclick="addEtiquette()">Ajouter</button>
                </div>
            </div>

            <br><br><!-- Supprimer les BR et les remplacer par du css -->
            
            <div id="answers">
                {% for i in range(0, nbAnswers) %}
                <div id="answer{{ i }}">
                    {% if question['answers'][i]['isCorrect'] %}
                        <input type="checkbox" name="correct{{ i }}" checked>
                    {% else %}
                        <input type="checkbox" name="correct{{ i }}">
                    {% endif %}
                    <input type="text" name="text{{ i }}" value='{{ question["answers"][i]["text"] }}'>
                </div>
                {% endfor %}
            </div>
            <button type="button" onclick="addAnswer()">Ajouter une réponse</button>
            <!--<button type="button" onclick="delAnswer()">Supprimer une réponse</button>-->
            <button type="button" class="btn btn-labeled btn-danger" onclick="delAnswer()">
                <span class="btn-label"><i class="fa fa-trash"></i></span>Supprimer
            </button>
            <button type="submit" class="btn btn-link"><span class="bi bi-pencil-fill"></span></button>
            <input type="hidden" name="id_question" value="{{ id_question }}">
            <input type="hidden" name="nbAnswers" value="{{ nbAnswers }}" id="nbAnswers">
        </form>
    </center>
   </body>
   
   
</html>